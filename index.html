<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beast Feast - –ö–∏–¥–∞—á –ö—É–±–∏–∫—ñ–≤</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gradient-to-br from-amber-50 via-orange-50 to-red-50 min-h-screen p-4">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6 border-l-4 border-amber-500">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4">
                <div>
                    <h1 class="text-3xl font-bold text-amber-800 mb-2">üçñ Beast Feast - –ö–∏–¥–∞—á –ö—É–±–∏–∫—ñ–≤</h1>
                    <p class="text-gray-600">–ö—É–ª—ñ–Ω–∞—Ä–Ω—ñ –ø—Ä–∏–≥–æ–¥–∏ –¥–ª—è Daggerheart</p>
                </div>
                <div class="flex space-x-4 mt-4 md:mt-0">
                    <div class="text-center">
                        <div class="text-2xl font-bold text-blue-600" id="rollCount">0</div>
                        <div class="text-xs text-gray-500">–ö–∏–¥–∫—ñ–≤</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-green-600" id="successCount">0</div>
                        <div class="text-xs text-gray-500">–°—Ç—Ä–∞–≤</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-purple-600" id="avgRating">0</div>
                        <div class="text-xs text-gray-500">–°–µ—Ä–µ–¥. —Ä–µ–π—Ç–∏–Ω–≥</div>
                    </div>
                </div>
            </div>
            
            <!-- –®–≤–∏–¥–∫—ñ –ø–æ—Ä–∞–¥–∏ -->
            <div class="bg-amber-50 border border-amber-200 rounded-lg p-4">
                <h3 class="font-semibold text-amber-800 mb-2">üí° –®–≤–∏–¥–∫—ñ –ø–æ—Ä–∞–¥–∏:</h3>
                <ul class="text-sm text-amber-700 space-y-1">
                    <li>‚Ä¢ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ <kbd class="px-1 py-0.5 bg-gray-200 rounded text-xs">Ctrl+Enter</kbd> –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –∫–∏–¥–∞–Ω–Ω—è</li>
                    <li>‚Ä¢ –ó–±–∏—Ä–∞–π—Ç–µ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏ –¥–ª—è –∫—É–ª—ñ–Ω–∞—Ä–Ω–æ—ó –∫–Ω–∏–≥–∏ –≤–∞—à–æ—ó –≥—Ä—É–ø–∏</li>
                    <li>‚Ä¢ –ë—ñ–ª—å—à–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ = –±—ñ–ª—å—à–µ —Ç–æ–∫–µ–Ω—ñ–≤ –¥–æ—Å–≤—ñ–¥—É –¥–ª—è —Å—Ö–æ–∂–∏—Ö —Å—Ç—Ä–∞–≤</li>
                    <li>‚Ä¢ –ü–µ—Ä—Å–æ–Ω–∞–∂ –º–æ–∂–µ –Ω–µ—Å—Ç–∏ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç—ñ–≤ = –Ω–∞–π–≤–∏—â–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞</li>
                </ul>
            </div>
        </div>

        <!-- –ü—Ä–∞–≤–∏–ª–∞ –≥—Ä–∏ -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-2xl font-semibold text-gray-800">üìö –ü—Ä–∞–≤–∏–ª–∞ Beast Feast</h2>
                <button onclick="toggleRules()" id="rulesToggle" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm">
                    –ü—Ä–∏—Ö–æ–≤–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞
                </button>
            </div>
            
            <div id="rulesContent" class="space-y-6">
                <!-- –ö—É–ª—ñ–Ω–∞—Ä–Ω–∞ –∫–Ω–∏–≥–∞ –≥—Ä—É–ø–∏ -->
                <div class="border-l-4 border-pink-500 pl-4">
                    <h3 class="text-lg font-semibold text-pink-800 mb-2">üìñ –ö—É–ª—ñ–Ω–∞—Ä–Ω–∞ –∫–Ω–∏–≥–∞ –≥—Ä—É–ø–∏</h3>
                    <div class="bg-pink-50 p-4 rounded-lg">
                        <p class="text-gray-700 mb-2">
                            <strong>–í–∞—à–∞ –≥—Ä—É–ø–∞ —Å—Ç–≤–æ—Ä—é—î —Å–ø—ñ–ª—å–Ω—É –∫—É–ª—ñ–Ω–∞—Ä–Ω—É –∫–Ω–∏–≥—É!</strong> –í—ñ–∑—å–º—ñ—Ç—å –Ω–µ–≤–µ–ª–∏–∫–∏–π –±–ª–æ–∫–Ω–æ—Ç, —è–∫–∏–π –≤–∏ –±—É–¥–µ—Ç–µ –¥—ñ–ª–∏—Ç–∏—Å—è, 
                            —Ç–∞ –ø—Ä–∏–∫—Ä–∞—Å—å—Ç–µ –π–æ–≥–æ (–Ω–∞–∫–ª–µ–π–∫–∏, –∫–æ–ª—å–æ—Ä–æ–≤—ñ –º–∞—Ä–∫–µ—Ä–∏ —Ç–∞ —Ñ–∞—Ä–±–∏ –¥—É–∂–µ –∑–∞–æ—Ö–æ—á—É—é—Ç—å—Å—è).
                        </p>
                        <p class="text-gray-700 mb-2">
                            –ü—ñ–¥ —á–∞—Å –≤—ñ–¥–ø–æ—á–∏–Ω–∫—É –∑–∞–ø–∏—Å—É–π—Ç–µ –∫–æ–∂–µ–Ω —Ä–µ—Ü–µ–ø—Ç, –≤–∫–ª—é—á–∞—é—á–∏:
                        </p>
                        <ul class="text-gray-700 ml-4 space-y-1">
                            <li>‚Ä¢ <strong>–ù–∞–∑–≤—É —Å—Ç—Ä–∞–≤–∏</strong></li>
                            <li>‚Ä¢ <strong>–Ü–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏</strong> —Ç–∞ —ó—Ö –ø—Ä–æ—Ñ—ñ–ª—ñ —Å–º–∞–∫—É</li>
                            <li>‚Ä¢ <strong>–°–ø–æ—Å—ñ–± –ø—Ä–∏–≥–æ—Ç—É–≤–∞–Ω–Ω—è</strong></li>
                            <li>‚Ä¢ <strong>–Ø–∫ –≤–∏–π—à–ª–æ</strong> (—Ä–µ–π—Ç–∏–Ω–≥ —Å—Ç—Ä–∞–≤–∏)</li>
                        </ul>
                        <p class="text-gray-700 mt-2">
                            <strong>–í–∞–∂–ª–∏–≤–æ:</strong> –ß–∏–º –±—ñ–ª—å—à–µ –ø–µ—Ä—Å–æ–Ω–∞–∂—ñ –ø—Ä–∞–∫—Ç–∏–∫—É—é—Ç—å –ø—Ä–∏–≥–æ—Ç—É–≤–∞–Ω–Ω—è —Å—Ç—Ä–∞–≤ –∑ –æ–¥–Ω–∞–∫–æ–≤–∏–º –ø—Ä–æ—Ñ—ñ–ª–µ–º —Å–º–∞–∫—É, 
                            —Ç–∏–º –ª–µ–≥—à–µ —Å—Ç–∞—î –≥–æ—Ç—É–≤–∞—Ç–∏ —Ç–∞–∫—ñ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó!
                        </p>
                    </div>
                </div>

                <!-- –û—Å–Ω–æ–≤–Ω–∞ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—è -->
                <div class="border-l-4 border-green-500 pl-4">
                    <h3 class="text-lg font-semibold text-green-800 mb-2">üéØ –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î</h3>
                    <div class="bg-green-50 p-4 rounded-lg">
                        <p class="text-gray-700 mb-2">
                            –ü—ñ–¥ —á–∞—Å –≤—ñ–¥–ø–æ—á–∏–Ω–∫—É –ø–µ—Ä—Å–æ–Ω–∞–∂—ñ –≤—ñ–¥–Ω–æ–≤–ª—é—é—Ç—å—Å—è, –≥–æ—Ç—É—é—á–∏ —Å—Ç—Ä–∞–≤–∏ –∑ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç—ñ–≤, –∑—ñ–±—Ä–∞–Ω–∏—Ö —É –ø–µ—á–µ—Ä–∞—Ö.
                        </p>
                        <p class="text-gray-700 mb-2">
                            <strong>–ú–µ—Ç–∞:</strong> –û—Ç—Ä–∏–º–∞—Ç–∏ –∑–±—ñ–≥–∏ –ø—Ä–∏ –∫–∏–¥–∞–Ω—ñ –∫—É–±–∏–∫—ñ–≤ —Å–º–∞–∫—É, —â–æ–± –ø—Ä–∏–≥–æ—Ç—É–≤–∞—Ç–∏ —É—Å–ø—ñ—à–Ω—É —Å—Ç—Ä–∞–≤—É!
                        </p>
                        <p class="text-gray-700">
                            <strong>–Ü–Ω–≤–µ–Ω—Ç–∞—Ä:</strong> –ü–µ—Ä—Å–æ–Ω–∞–∂ –º–æ–∂–µ –Ω–µ—Å—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç—ñ–≤ = –∑–Ω–∞—á–µ–Ω–Ω—è –π–æ–≥–æ –Ω–∞–π–≤–∏—â–æ—ó —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏.
                        </p>
                    </div>
                </div>

                <!-- –°–º–∞–∫–∏ —Ç–∞ –∫—É–±–∏–∫–∏ -->
                <div class="border-l-4 border-blue-500 pl-4">
                    <h3 class="text-lg font-semibold text-blue-800 mb-3">üé≤ –°–º–∞–∫–∏ —Ç–∞ —ó—Ö –∫—É–±–∏–∫–∏</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        <div class="flex items-center space-x-3 p-3 bg-pink-50 rounded-lg border border-pink-200">
                            <span class="text-2xl">üçØ</span>
                            <div>
                                <div class="font-medium text-pink-800">–°–æ–ª–æ–¥–∫–∏–π (–∫4)</div>
                                <div class="text-sm text-pink-600">–ù–∞–π–±—ñ–ª—å—à–µ —à–∞–Ω—Å—ñ–≤ –∑–±—ñ–≥—ñ–≤</div>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3 p-3 bg-blue-50 rounded-lg border border-blue-200">
                            <span class="text-2xl">üßÇ</span>
                            <div>
                                <div class="font-medium text-blue-800">–°–æ–ª–æ–Ω–∏–π (–∫6)</div>
                                <div class="text-sm text-blue-600">–ë–∞–∑–æ–≤–∏–π —Å–º–∞–∫</div>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3 p-3 bg-green-50 rounded-lg border border-green-200">
                            <span class="text-2xl">üåø</span>
                            <div>
                                <div class="font-medium text-green-800">–ì—ñ—Ä–∫–∏–π (–∫8)</div>
                                <div class="text-sm text-green-600">–ü–æ–º—ñ—Ä–Ω–∏–π —Ä–∏–∑–∏–∫</div>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3 p-3 bg-yellow-50 rounded-lg border border-yellow-200">
                            <span class="text-2xl">üçã</span>
                            <div>
                                <div class="font-medium text-yellow-800">–ö–∏—Å–ª–∏–π (–∫10)</div>
                                <div class="text-sm text-yellow-600">–í–∏—Å–æ–∫–∏–π —Ä–∏–∑–∏–∫</div>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3 p-3 bg-red-50 rounded-lg border border-red-200">
                            <span class="text-2xl">ü•©</span>
                            <div>
                                <div class="font-medium text-red-800">–°–º–∞—á–Ω–∏–π (–∫12)</div>
                                <div class="text-sm text-red-600">–ù–∞–π–≤–∏—â–∏–π —Ä–∏–∑–∏–∫</div>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3 p-3 bg-purple-50 rounded-lg border border-purple-200">
                            <span class="text-2xl">üîÆ</span>
                            <div>
                                <div class="font-medium text-purple-800">–î–∏–≤–Ω–∏–π (–∫20)</div>
                                <div class="text-sm text-purple-600">–ù–µ–ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω—ñ –µ—Ñ–µ–∫—Ç–∏</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –Ø–∫ –≥—Ä–∞—Ç–∏ -->
                <div class="border-l-4 border-orange-500 pl-4">
                    <h3 class="text-lg font-semibold text-orange-800 mb-3">üç≥ –Ø–∫ –≥–æ—Ç—É–≤–∞—Ç–∏ —Å—Ç—Ä–∞–≤–∏</h3>
                    <div class="space-y-3">
                        <div class="bg-orange-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-orange-800 mb-2">–ö—Ä–æ–∫ 1: –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç—ñ–≤</h4>
                            <ul class="text-gray-700 space-y-1 ml-4">
                                <li>‚Ä¢ –û–±–µ—Ä—ñ—Ç—å —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏ –∑ –≤–∞—à–æ–≥–æ —ñ–Ω–≤–µ–Ω—Ç–∞—Ä—è</li>
                                <li>‚Ä¢ –í–≤–µ–¥—ñ—Ç—å –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫—É–±–∏–∫—ñ–≤ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Å–º–∞–∫—É (—Å–∏–ª–∞ —Å–º–∞–∫—É = –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫—É–±–∏–∫—ñ–≤)</li>
                                <li>‚Ä¢ –î–æ–¥–∞–π—Ç–µ —Ç–æ–∫–µ–Ω–∏ –¥–æ—Å–≤—ñ–¥—É, —è–∫—â–æ –≤–∏ –≤–∂–µ –≥–æ—Ç—É–≤–∞–ª–∏ —Å—Ö–æ–∂—ñ —Å—Ç—Ä–∞–≤–∏</li>
                            </ul>
                        </div>
                        
                        <div class="bg-orange-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-orange-800 mb-2">–ö—Ä–æ–∫ 2: –ö–∏–¥–∞–Ω–Ω—è –∫—É–±–∏–∫—ñ–≤ —Å–º–∞–∫—É</h4>
                            <ul class="text-gray-700 space-y-1 ml-4">
                                <li>‚Ä¢ –ö–∏–Ω—å—Ç–µ –≤—Å—ñ –∫—É–±–∏–∫–∏ –æ–¥–Ω–æ—á–∞—Å–Ω–æ</li>
                                <li>‚Ä¢ –®—É–∫–∞–π—Ç–µ <strong>–∑–±—ñ–≥–∏</strong> - –∫—É–±–∏–∫–∏ –∑ –æ–¥–Ω–∞–∫–æ–≤–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏</li>
                                <li>‚Ä¢ –ó–±—ñ–≥–∏ –æ–∑–Ω–∞—á–∞—é—Ç—å —É—Å–ø—ñ—à–Ω–µ –∑–º—ñ—à—É–≤–∞–Ω–Ω—è —Å–º–∞–∫—ñ–≤</li>
                            </ul>
                        </div>
                        
                        <div class="bg-orange-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-orange-800 mb-2">–ö—Ä–æ–∫ 3: –û–±—Ä–æ–±–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤</h4>
                            <ul class="text-gray-700 space-y-1 ml-4">
                                <li>‚Ä¢ <strong>–Ñ –∑–±—ñ–≥–∏?</strong> - –í–∏–¥–∞–ª—è—î–º–æ –≤—Å—ñ –∫—É–±–∏–∫–∏ –∑—ñ –∑–±—ñ–≥–∞–º–∏, –∑–∞–ª–∏—à–∞—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è</li>
                                <li>‚Ä¢ <strong>–ù–µ–º–∞—î –∑–±—ñ–≥—ñ–≤?</strong> - –í–∏–±–∏—Ä–∞—î–º–æ –æ–¥–∏–Ω –∫—É–±–∏–∫/—Ç–æ–∫–µ–Ω –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è</li>
                                <li>‚Ä¢ –ü–µ—Ä–µ–∫–∏–¥–∞—î–º–æ —Ä–µ—à—Ç—É –∫—É–±–∏–∫—ñ–≤</li>
                                <li>‚Ä¢ –ü–æ–≤—Ç–æ—Ä—é—î–º–æ –¥–æ –æ–¥–Ω–æ–≥–æ –∫—É–±–∏–∫–∞</li>
                                <li>‚Ä¢ <strong>–†–µ–π—Ç–∏–Ω–≥ —Å—Ç—Ä–∞–≤–∏</strong> = —Å—É–º–∞ –≤—Å—ñ—Ö —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö –∑–±—ñ–≥—ñ–≤</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- –ü—Ä–∏–∫–ª–∞–¥–∏ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç—ñ–≤ -->
                <div class="border-l-4 border-purple-500 pl-4">
                    <h3 class="text-lg font-semibold text-purple-800 mb-3">üçÑ –ë–∞–∑–æ–≤—ñ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-purple-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-purple-800 mb-2">–ó–≤–∏—á–∞–π–Ω—ñ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏:</h4>
                            <ul class="text-sm text-gray-700 space-y-1">
                                <li>‚Ä¢ <strong>üçÑ –ì—Ä–∏–±–Ω—ñ —à–∞–ø–∫–∏:</strong> –ì—ñ—Ä–∫–∏–π(1) + –°–º–∞—á–Ω–∏–π(2)</li>
                                <li>‚Ä¢ <strong>ü•© –ú'—è—Å–æ –ª—é—Ç–æ–≤–µ–ø—Ä–∞:</strong> –°–º–∞—á–Ω–∏–π(3)</li>
                                <li>‚Ä¢ <strong>ü•õ –ú–æ–ª–æ–∫–æ –ø–µ—á–µ—Ä–Ω–æ–≥–æ –∫–∞–±–∞–Ω–∞:</strong> –°–æ–ª–æ–Ω–∏–π(1) + –°–º–∞—á–Ω–∏–π(1)</li>
                                <li>‚Ä¢ <strong>üåø –ö–æ—Ä—ñ–Ω—å —Ä—ñ–ª—ñ:</strong> –ì—ñ—Ä–∫–∏–π(1)</li>
                                <li>‚Ä¢ <strong>üíß –°–ª–∏–Ω–∞ –∫–∏—Å–ª–æ—Ç–Ω–æ–≥–æ –¥—Ä–∞–∫–æ–Ω–∞:</strong> –ö–∏—Å–ª–∏–π(2)</li>
                            </ul>
                        </div>
                        
                        <div class="bg-purple-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-purple-800 mb-2">–ï–∫–∑–æ—Ç–∏—á–Ω—ñ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏:</h4>
                            <ul class="text-sm text-gray-700 space-y-1">
                                <li>‚Ä¢ <strong>üëÖ –Ø–∑–∏–∫ –≤—ñ–≤—Ä–µ–Ω–∏:</strong> –ö–∏—Å–ª–∏–π(1) + –°–º–∞—á–Ω–∏–π(1) + –î–∏–≤–Ω–∏–π(1)</li>
                                <li>‚Ä¢ <strong>üß† –ú–æ–∑–æ–∫ —Å–ª–∏–∑—É:</strong> –°–æ–ª–æ–¥–∫–∏–π(1) + –ì—ñ—Ä–∫–∏–π(2)</li>
                                <li>‚Ä¢ <strong>üíé –ù–∏—Ä–∫–æ–≤—ñ –∫–∞–º–µ–Ω—ñ –æ–≥—Ä–∞:</strong> –°–æ–ª–æ–¥–∫–∏–π(1) + –î–∏–≤–Ω–∏–π(1)</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- –ü—Ä–æ—Å—É–Ω—É—Ç—ñ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏ -->
                <div class="border-l-4 border-red-500 pl-4">
                    <h3 class="text-lg font-semibold text-red-800 mb-3">‚≠ê –û—Å–æ–±–ª–∏–≤—ñ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏</h3>
                    <p class="text-gray-700 mb-3">
                        –¶—ñ —Ä—ñ–¥–∫—ñ—Å–Ω—ñ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏ –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –ª–∏—à–µ –∑ –õ—ñ–¥–µ—Ä—ñ–≤ –∞–±–æ –ë–æ—Å—ñ–≤. –í–æ–Ω–∏ –º–∞—é—Ç—å –æ—Å–æ–±–ª–∏–≤—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ:
                    </p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-red-50 p-4 rounded-lg border border-red-200">
                            <h4 class="font-semibold text-red-800 mb-2">ü¶å –ú–æ–∑–æ–∫ —á–µ—Ä–µ–ø–∞ –≥–∞–∑–µ–ª—ñ</h4>
                            <p class="text-sm text-gray-700 mb-2">–°–æ–ª–æ–¥–∫–∏–π(1) + –°–æ–ª–æ–Ω–∏–π(1) + –ö–∏—Å–ª–∏–π(1)</p>
                            <p class="text-xs text-red-700 bg-red-100 p-2 rounded">
                                <strong>–®–≤–∏–¥–∫—ñ—Å—Ç—å:</strong> +1 –¥–æ –°–ø—Ä–∏—Ç–Ω–æ—Å—Ç—ñ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∫–æ—Ä–æ—Ç–∫–æ–≥–æ –≤—ñ–¥–ø–æ—á–∏–Ω–∫—É
                            </p>
                        </div>
                        
                        <div class="bg-red-50 p-4 rounded-lg border border-red-200">
                            <h4 class="font-semibold text-red-800 mb-2">ü•õ –ú–æ–ª–æ–∫–æ —Å–≤—è—â–µ–Ω–Ω–æ—ó –∫–æ—Ä–æ–≤–∏</h4>
                            <p class="text-sm text-gray-700 mb-2">–î–∏–≤–Ω–∏–π(1)</p>
                            <p class="text-xs text-red-700 bg-red-100 p-2 rounded">
                                <strong>–û—Å—Ç–∞–Ω–Ω—è –∫—Ä–∞–ø–ª—è:</strong> –ö–æ–ª–∏ –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –æ–¥–∏–Ω –∫—É–±–∏–∫, –¥–æ–¥–∞–π –π–æ–≥–æ –¥–æ —Ä–µ–π—Ç–∏–Ω–≥—É —Å—Ç—Ä–∞–≤–∏
                            </p>
                        </div>
                        
                        <div class="bg-red-50 p-4 rounded-lg border border-red-200">
                            <h4 class="font-semibold text-red-800 mb-2">ü¶Ç –û—Ç—Ä—É—Ç–∞ —Å–∫–æ—Ä–ø—ñ–æ–Ω–∞-–ø—Ä–∏–≤–∏–¥–∞</h4>
                            <p class="text-sm text-gray-700 mb-2">–ö–∏—Å–ª–∏–π(1) + –°–º–∞—á–Ω–∏–π(1)</p>
                            <p class="text-xs text-red-700 bg-red-100 p-2 rounded">
                                <strong>–ì–æ—Å—Ç—Ä–∞:</strong> –Ø–∫—â–æ –∑–±—ñ–≥–∏ –Ω–∞ 8+, –Ω–µ –º–æ–∂–Ω–∞ –æ—á–∏—Å—Ç–∏—Ç–∏ —Å—Ç—Ä–µ—Å —Ü—ñ—î—é —Å—Ç—Ä–∞–≤–æ—é
                            </p>
                        </div>
                        
                        <div class="bg-red-50 p-4 rounded-lg border border-red-200">
                            <h4 class="font-semibold text-red-800 mb-2">üå∏ –ö–≤—ñ—Ç–∫–∞ —Å–º–µ—Ä—Ç—ñ</h4>
                            <p class="text-sm text-gray-700 mb-2">–ì—ñ—Ä–∫–∏–π(2)</p>
                            <p class="text-xs text-red-700 bg-red-100 p-2 rounded">
                                <strong>–†–∏–∑–∏–∫–æ–≤–∞–Ω–∞:</strong> –ù–µ–º–∞—î –∑–±—ñ–≥—ñ–≤ = –æ—á–∏—Å—Ç–∏ –≤—Å–µ + 3 –ù–∞–¥—ñ—è. –Ñ –∑–±—ñ–≥–∏ = –∫–∏–¥–æ–∫ —Å–º–µ—Ä—Ç—ñ
                            </p>
                        </div>
                    </div>
                </div>

                <!-- –¢–æ–∫–µ–Ω–∏ –¥–æ—Å–≤—ñ–¥—É -->
                <div class="border-l-4 border-yellow-500 pl-4">
                    <h3 class="text-lg font-semibold text-yellow-800 mb-2">ü™ô –¢–æ–∫–µ–Ω–∏ –¥–æ—Å–≤—ñ–¥—É</h3>
                    <div class="bg-yellow-50 p-4 rounded-lg">
                        <p class="text-gray-700 mb-2">
                            <strong>–Ø–∫ –æ—Ç—Ä–∏–º–∞—Ç–∏:</strong> –ó–∞ —É—Å–ø—ñ—à–Ω–µ –ø—Ä–∏–≥–æ—Ç—É–≤–∞–Ω–Ω—è —Å—Ç—Ä–∞–≤ –∑ –ø–µ–≤–Ω–∏–º –ø—Ä–æ—Ñ—ñ–ª–µ–º —Å–º–∞–∫—É –≥—Ä—É–ø–∞ –æ—Ç—Ä–∏–º—É—î —Ç–æ–∫–µ–Ω–∏.
                        </p>
                        <p class="text-gray-700 mb-2">
                            <strong>–Ø–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:</strong> –ü—Ä–∏ –≤—ñ–¥—Å—É—Ç–Ω–æ—Å—Ç—ñ –∑–±—ñ–≥—ñ–≤ –º–æ–∂–Ω–∞ "–≤–∏—Ç—Ä–∞—Ç–∏—Ç–∏" —Ç–æ–∫–µ–Ω –∑–∞–º—ñ—Å—Ç—å –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∫—É–±–∏–∫–∞.
                        </p>
                        <p class="text-gray-700">
                            <strong>–ü—Ä–æ–≥—Ä–µ—Å—ñ—è:</strong> –ß–∏–º –±—ñ–ª—å—à–µ –≥–æ—Ç—É—î—Ç–µ —Å—Ö–æ–∂—ñ —Å—Ç—Ä–∞–≤–∏, —Ç–∏–º –ª–µ–≥—à–µ —Å—Ç–∞—î —ó—Ö –≥–æ—Ç—É–≤–∞—Ç–∏ —É –º–∞–π–±—É—Ç–Ω—å–æ–º—É!
                        </p>
                    </div>
                </div>

                <!-- –û—Ü—ñ–Ω–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ -->
                <div class="border-l-4 border-gray-500 pl-4">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3">üèÜ –†–µ–π—Ç–∏–Ω–≥ —Å—Ç—Ä–∞–≤</h3>
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <p class="text-gray-700 mb-3">
                            <strong>–†–µ–π—Ç–∏–Ω–≥ —Å—Ç—Ä–∞–≤–∏</strong> = —Å—É–º–∞ –≤—Å—ñ—Ö —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å –∑–±—ñ–≥—ñ–≤
                        </p>
                        <div class="grid grid-cols-2 md:grid-cols-5 gap-3 text-sm">
                            <div class="text-center p-2 bg-gray-200 rounded">
                                <div class="font-bold text-gray-800">0-4</div>
                                <div class="text-gray-600">–ü—Ä–æ–≤–∞–ª</div>
                            </div>
                            <div class="text-center p-2 bg-yellow-200 rounded">
                                <div class="font-bold text-yellow-800">5-9</div>
                                <div class="text-yellow-600">–ó–≤–∏—á–∞–π–Ω–∞</div>
                            </div>
                            <div class="text-center p-2 bg-green-200 rounded">
                                <div class="font-bold text-green-800">10-14</div>
                                <div class="text-green-600">–•–æ—Ä–æ—à–∞</div>
                            </div>
                            <div class="text-center p-2 bg-orange-200 rounded">
                                <div class="font-bold text-orange-800">15-19</div>
                                <div class="text-orange-600">–í—ñ–¥–º—ñ–Ω–Ω–∞</div>
                            </div>
                            <div class="text-center p-2 bg-purple-200 rounded">
                                <div class="font-bold text-purple-800">20+</div>
                                <div class="text-purple-600">–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å —à–≤–∏–¥–∫–∏—Ö —Ä–µ—Ü–µ–ø—Ç—ñ–≤ —Ç–∞ —ñ—Å—Ç–æ—Ä—ñ—ó -->
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 mb-6">
            <!-- –®–≤–∏–¥–∫—ñ –ø—Ä–µ—Å–µ—Ç–∏ -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">üçΩÔ∏è –®–≤–∏–¥–∫—ñ —Ä–µ—Ü–µ–ø—Ç–∏</h2>
                <div class="space-y-2">
                    <button onclick="loadPreset('simple')" class="w-full text-left p-3 bg-green-50 hover:bg-green-100 rounded-lg border border-green-200 transition-colors">
                        <div class="font-medium text-green-800">–ü—Ä–æ—Å—Ç–∏–π —Å—É–ø</div>
                        <div class="text-sm text-green-600">üßÇ –°–æ–ª–æ–Ω–∏–π(1) + ü•© –°–º–∞—á–Ω–∏–π(2)</div>
                    </button>
                    <button onclick="loadPreset('wyvern')" class="w-full text-left p-3 bg-orange-50 hover:bg-orange-100 rounded-lg border border-orange-200 transition-colors">
                        <div class="font-medium text-orange-800">–Ø–∑–∏–∫ –≤—ñ–≤—Ä–µ–Ω–∏</div>
                        <div class="text-sm text-orange-600">üçã ü•© üîÆ (–ø–æ 1)</div>
                    </button>
                    <button onclick="loadPreset('mushroom')" class="w-full text-left p-3 bg-gray-50 hover:bg-gray-100 rounded-lg border border-gray-200 transition-colors">
                        <div class="font-medium text-gray-800">–ì—Ä–∏–±–Ω—ñ —à–∞–ø–∫–∏</div>
                        <div class="text-sm text-gray-600">üåø(1) + ü•©(2)</div>
                    </button>
                    <button onclick="loadPreset('complex')" class="w-full text-left p-3 bg-purple-50 hover:bg-purple-100 rounded-lg border border-purple-200 transition-colors">
                        <div class="font-medium text-purple-800">–ú–∞–≥—ñ—á–Ω–µ —Ä–∞–≥—É</div>
                        <div class="text-sm text-purple-600">–í—Å—ñ —Å–º–∞–∫–∏ –ø–æ 1</div>
                    </button>
                    <button onclick="loadPreset('special')" class="w-full text-left p-3 bg-red-50 hover:bg-red-100 rounded-lg border border-red-200 transition-colors">
                        <div class="font-medium text-red-800">–ú–æ–∑–æ–∫ –≥–∞–∑–µ–ª—ñ</div>
                        <div class="text-sm text-red-600">üçØ üßÇ üçã (–ø–æ 1)</div>
                    </button>
                </div>
            </div>

            <!-- –Ü—Å—Ç–æ—Ä—ñ—è –∫–∏–¥–∫—ñ–≤ -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">üìú –Ü—Å—Ç–æ—Ä—ñ—è</h2>
                <div id="historyList" class="space-y-2 max-h-48 overflow-y-auto">
                    <p class="text-gray-500 text-sm italic">–Ü—Å—Ç–æ—Ä—ñ—è –∫–∏–¥–∫—ñ–≤ –∑'—è–≤–∏—Ç—å—Å—è —Ç—É—Ç...</p>
                </div>
                <button onclick="clearHistory()" class="mt-3 text-sm text-red-600 hover:text-red-800">–û—á–∏—Å—Ç–∏—Ç–∏ —ñ—Å—Ç–æ—Ä—ñ—é</button>
            </div>

            <!-- –ö—É–ª—ñ–Ω–∞—Ä–Ω–∞ –∫–Ω–∏–≥–∞ -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">üìñ –ö—É–ª—ñ–Ω–∞—Ä–Ω–∞ –∫–Ω–∏–≥–∞ –≥—Ä—É–ø–∏</h2>
                <div id="cookbook" class="space-y-2 max-h-48 overflow-y-auto">
                    <p class="text-gray-500 text-sm italic">–£—Å–ø—ñ—à–Ω—ñ —Ä–µ—Ü–µ–ø—Ç–∏ –∑'—è–≤–ª—è—Ç—å—Å—è —Ç—É—Ç...</p>
                </div>
                <button onclick="exportCookbook()" class="mt-3 text-sm text-blue-600 hover:text-blue-800">–ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –∫–Ω–∏–≥—É</button>
            </div>

            <!-- –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç—ñ–≤ -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">üé≤ –í–∏–ø–∞–¥–∫–æ–≤—ñ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏</h2>
                <div id="randomIngredient" class="mb-4">
                    <div class="p-3 bg-gray-50 rounded-lg border text-center">
                        <div class="text-gray-500 text-sm">–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó</div>
                    </div>
                </div>
                <button onclick="generateRandomIngredient()" class="w-full bg-indigo-500 hover:bg-indigo-600 text-white py-2 px-4 rounded-lg mb-2">
                    –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç
                </button>
                <button onclick="addRandomToMeal()" class="w-full bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded-lg text-sm">
                    –î–æ–¥–∞—Ç–∏ –¥–æ —Å—Ç—Ä–∞–≤–∏
                </button>
            </div>
        </div>

        <!-- –Ü–Ω–ø—É—Ç–∏ –¥–ª—è —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç—ñ–≤ -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-semibold text-gray-800">ü•Ñ –°–∫–ª–∞–¥–Ω–∏–∫–∏ –≤–∞—à–æ—ó —Å—Ç—Ä–∞–≤–∏</h2>
                <div class="flex space-x-2">
                    <button onclick="randomizeIngredients()" class="px-3 py-1 bg-yellow-500 hover:bg-yellow-600 text-white rounded text-sm transition-colors">
                        üé≤ –í–∏–ø–∞–¥–∫–æ–≤–æ
                    </button>
                    <button onclick="clearAll()" class="px-3 py-1 bg-gray-500 hover:bg-gray-600 text-white rounded text-sm transition-colors">
                        üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏
                    </button>
                </div>
            </div>
            
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                <div class="ingredient-input" data-flavor="sweet">
                    <label class="block text-sm font-medium text-gray-700 mb-1">
                        <span class="inline-block w-3 h-3 bg-pink-400 rounded-full mr-2"></span>
                        üçØ –°–æ–ª–æ–¥–∫–∏–π (–∫4):
                    </label>
                    <div class="relative">
                        <input type="number" id="sweet" min="0" max="10" value="0" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500 transition-colors">
                        <div class="absolute right-2 top-1/2 transform -translate-y-1/2 flex space-x-1">
                            <button onclick="adjustInput('sweet', -1)" class="w-6 h-6 bg-gray-200 hover:bg-gray-300 rounded text-xs">-</button>
                            <button onclick="adjustInput('sweet', 1)" class="w-6 h-6 bg-gray-200 hover:bg-gray-300 rounded text-xs">+</button>
                        </div>
                    </div>
                </div>
                
                <div class="ingredient-input" data-flavor="salty">
                    <label class="block text-sm font-medium text-gray-700 mb-1">
                        <span class="inline-block w-3 h-3 bg-blue-400 rounded-full mr-2"></span>
                        üßÇ –°–æ–ª–æ–Ω–∏–π (–∫6):
                    </label>
                    <div class="relative">
                        <input type="number" id="salty" min="0" max="10" value="0" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors">
                        <div class="absolute right-2 top-1/2 transform -translate-y-1/2 flex space-x-1">
                            <button onclick="adjustInput('salty', -1)" class="w-6 h-6 bg-gray-200 hover:bg-gray-300 rounded text-xs">-</button>
                            <button onclick="adjustInput('salty', 1)" class="w-6 h-6 bg-gray-200 hover:bg-gray-300 rounded text-xs">+</button>
                        </div>
                    </div>
                </div>
                
                <div class="ingredient-input" data-flavor="bitter">
                    <label class="block text-sm font-medium text-gray-700 mb-1">
                        <span class="inline-block w-3 h-3 bg-green-600 rounded-full mr-2"></span>
                        üåø –ì—ñ—Ä–∫–∏–π (–∫8):
                    </label>
                    <div class="relative">
                        <input type="number" id="bitter" min="0" max="10" value="0" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors">
                        <div class="absolute right-2 top-1/2 transform -translate-y-1/2 flex space-x-1">
                            <button onclick="adjustInput('bitter', -1)" class="w-6 h-6 bg-gray-200 hover:bg-gray-300 rounded text-xs">-</button>
                            <button onclick="adjustInput('bitter', 1)" class="w-6 h-6 bg-gray-200 hover:bg-gray-300 rounded text-xs">+</button>
                        </div>
                    </div>
                </div>
                
                <div class="ingredient-input" data-flavor="sour">
                    <label class="block text-sm font-medium text-gray-700 mb-1">
                        <span class="inline-block w-3 h-3 bg-yellow-400 rounded-full mr-2"></span>
                        üçã –ö–∏—Å–ª–∏–π (–∫10):
                    </label>
                    <div class="relative">
                        <input type="number" id="sour" min="0" max="10" value="0" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500 transition-colors">
                        <div class="absolute right-2 top-1/2 transform -translate-y-1/2 flex space-x-1">
                            <button onclick="adjustInput('sour', -1)" class="w-6 h-6 bg-gray-200 hover:bg-gray-300 rounded text-xs">-</button>
                            <button onclick="adjustInput('sour', 1)" class="w-6 h-6 bg-gray-200 hover:bg-gray-300 rounded text-xs">+</button>
                        </div>
                    </div>
                </div>
                
                <div class="ingredient-input" data-flavor="savory">
                    <label class="block text-sm font-medium text-gray-700 mb-1">
                        <span class="inline-block w-3 h-3 bg-red-500 rounded-full mr-2"></span>
                        ü•© –°–º–∞—á–Ω–∏–π (–∫12):
                    </label>
                    <div class="relative">
                        <input type="number" id="savory" min="0" max="10" value="0" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors">
                        <div class="absolute right-2 top-1/2 transform -translate-y-1/2 flex space-x-1">
                            <button onclick="adjustInput('savory', -1)" class="w-6 h-6 bg-gray-200 hover:bg-gray-300 rounded text-xs">-</button>
                            <button onclick="adjustInput('savory', 1)" class="w-6 h-6 bg-gray-200 hover:bg-gray-300 rounded text-xs">+</button>
                        </div>
                    </div>
                </div>
                
                <div class="ingredient-input" data-flavor="weird">
                    <label class="block text-sm font-medium text-gray-700 mb-1">
                        <span class="inline-block w-3 h-3 bg-purple-600 rounded-full mr-2"></span>
                        üîÆ –î–∏–≤–Ω–∏–π (–∫20):
                    </label>
                    <div class="relative">
                        <input type="number" id="weird" min="0" max="10" value="0" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors">
                        <div class="absolute right-2 top-1/2 transform -translate-y-1/2 flex space-x-1">
                            <button onclick="adjustInput('weird', -1)" class="w-6 h-6 bg-gray-200 hover:bg-gray-300 rounded text-xs">-</button>
                            <button onclick="adjustInput('weird', 1)" class="w-6 h-6 bg-gray-200 hover:bg-gray-300 rounded text-xs">+</button>
                        </div>
                    </div>
                </div>
                
                <div class="col-span-2">
                    <label class="block text-sm font-medium text-gray-700 mb-1">
                        <span class="inline-block w-3 h-3 bg-gray-400 rounded-full mr-2"></span>
                        ü™ô –¢–æ–∫–µ–Ω–∏ –¥–æ—Å–≤—ñ–¥—É:
                    </label>
                    <div class="relative">
                        <input type="number" id="token" min="0" max="20" value="0" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 transition-colors">
                        <div class="absolute right-2 top-1/2 transform -translate-y-1/2 flex space-x-1">
                            <button onclick="adjustInput('token', -1)" class="w-6 h-6 bg-gray-200 hover:bg-gray-300 rounded text-xs">-</button>
                            <button onclick="adjustInput('token', 1)" class="w-6 h-6 bg-gray-200 hover:bg-gray-300 rounded text-xs">+</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –ü–µ—Ä–µ–¥–±–∞—á–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É -->
            <div id="prediction" class="mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg hidden">
                <p class="text-blue-800 text-sm"></p>
            </div>
            
            <div class="flex space-x-3">
                <button onclick="startRolling()" id="rollButton" 
                        class="flex-1 bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200 transform hover:scale-105 flex items-center justify-center space-x-2">
                    <span>üç≥</span>
                    <span>–ü—Ä–∏–≥–æ—Ç—É–≤–∞—Ç–∏ —Å—Ç—Ä–∞–≤—É</span>
                </button>
                <button onclick="savePreset()" class="bg-green-500 hover:bg-green-600 text-white font-semibold py-3 px-4 rounded-lg transition duration-200">
                    üíæ
                </button>
            </div>
        </div>

        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ -->
        <div id="results" class="bg-white rounded-lg shadow-lg p-6 hidden">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø—Ä–∏–≥–æ—Ç—É–≤–∞–Ω–Ω—è</h2>
            <div id="output" class="space-y-4"></div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–µ—Ü–µ–ø—Ç—É -->
    <div id="saveModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4">
            <h3 class="text-lg font-semibold mb-4">üíæ –î–æ–¥–∞—Ç–∏ –¥–æ –∫—É–ª—ñ–Ω–∞—Ä–Ω–æ—ó –∫–Ω–∏–≥–∏</h3>
            <input type="text" id="recipeName" placeholder="–ù–∞–∑–≤–∞ —Å—Ç—Ä–∞–≤–∏..." 
                   class="w-full p-3 border border-gray-300 rounded-lg mb-4">
            <textarea id="recipeNotes" placeholder="–ù–æ—Ç–∞—Ç–∫–∏ –ø—Ä–æ –ø—Ä–∏–≥–æ—Ç—É–≤–∞–Ω–Ω—è (–Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ)..." 
                      class="w-full p-3 border border-gray-300 rounded-lg mb-4 h-20 resize-none"></textarea>
            <div class="flex space-x-3">
                <button onclick="confirmSavePreset()" class="flex-1 bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded-lg">
                    –ó–±–µ—Ä–µ–≥—Ç–∏ —É –∫–Ω–∏–∑—ñ
                </button>
                <button onclick="closeSaveModal()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 px-4 rounded-lg">
                    –°–∫–∞—Å—É–≤–∞—Ç–∏
                </button>
            </div>
        </div>
    </div>

    <script>
        // –î–∞–Ω—ñ –∫—É–±–∏–∫—ñ–≤ –∑ –µ–º–æ–¥–∑—ñ
        const diceTypes = {
            'sweet': { sides: 4, name: '–°–æ–ª–æ–¥–∫–∏–π', color: 'pink', emoji: 'üçØ' },
            'salty': { sides: 6, name: '–°–æ–ª–æ–Ω–∏–π', color: 'blue', emoji: 'üßÇ' },
            'bitter': { sides: 8, name: '–ì—ñ—Ä–∫–∏–π', color: 'green', emoji: 'üåø' },
            'sour': { sides: 10, name: '–ö–∏—Å–ª–∏–π', color: 'yellow', emoji: 'üçã' },
            'savory': { sides: 12, name: '–°–º–∞—á–Ω–∏–π', color: 'red', emoji: 'ü•©' },
            'weird': { sides: 20, name: '–î–∏–≤–Ω–∏–π', color: 'purple', emoji: 'üîÆ' }
        };

        // –ë–∞–∑–æ–≤—ñ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏
        const baseIngredients = [
            { name: "–ì—Ä–∏–±–Ω—ñ —à–∞–ø–∫–∏", ingredients: { bitter: 1, savory: 2 }, emoji: "üçÑ" },
            { name: "–ú'—è—Å–æ –ª—é—Ç–æ–≤–µ–ø—Ä–∞", ingredients: { savory: 3 }, emoji: "ü•©" },
            { name: "–ú–æ–ª–æ–∫–æ –ø–µ—á–µ—Ä–Ω–æ–≥–æ –∫–∞–±–∞–Ω–∞", ingredients: { salty: 1, savory: 1 }, emoji: "ü•õ" },
            { name: "–ö–æ—Ä—ñ–Ω—å —Ä—ñ–ª—ñ", ingredients: { bitter: 1 }, emoji: "üåø" },
            { name: "–°–ª–∏–Ω–∞ –∫–∏—Å–ª–æ—Ç–Ω–æ–≥–æ –¥—Ä–∞–∫–æ–Ω–∞", ingredients: { sour: 2 }, emoji: "üíß" },
            { name: "–Ø–∑–∏–∫ –≤—ñ–≤—Ä–µ–Ω–∏", ingredients: { sour: 1, savory: 1, weird: 1 }, emoji: "üëÖ" },
            { name: "–ú–æ–∑–æ–∫ —Å–ª–∏–∑—É", ingredients: { sweet: 1, bitter: 2 }, emoji: "üß†" },
            { name: "–ù–∏—Ä–∫–æ–≤—ñ –∫–∞–º–µ–Ω—ñ –æ–≥—Ä–∞", ingredients: { sweet: 1, weird: 1 }, emoji: "üíé" },
            { name: "–ü–µ—á–µ—Ä–Ω—ñ —è–≥–æ–¥–∏", ingredients: { sweet: 2, sour: 1 }, emoji: "ü´ê" },
            { name: "–ú–æ—Ö —Å—Ç–∞–ª–∞–∫—Ç–∏—Ç—ñ–≤", ingredients: { bitter: 1, weird: 1 }, emoji: "üü¢" },
            { name: "–ö—Ä–æ–≤ –ª–µ—Ç—é—á–æ—ó –º–∏—à—ñ", ingredients: { salty: 1, weird: 1 }, emoji: "ü©∏" },
            { name: "–ü–µ—á–µ—Ä–Ω–∞ —Ä–∏–±–∞", ingredients: { salty: 2, savory: 1 }, emoji: "üêü" }
        ];

        // –ó–º—ñ–Ω–Ω—ñ —Å—Ç–∞–Ω—É
        let currentDice = [];
        let matchedValues = [];
        let rollCount = parseInt(localStorage.getItem('beastFeastRollCount') || '0');
        let successCount = parseInt(localStorage.getItem('beastFeastSuccessCount') || '0');
        let totalRating = parseInt(localStorage.getItem('beastFeastTotalRating') || '0');
        let gameHistory = JSON.parse(localStorage.getItem('beastFeastHistory') || '[]');
        let cookbook = JSON.parse(localStorage.getItem('beastFeastCookbook') || '[]');
        let savedPresets = JSON.parse(localStorage.getItem('beastFeastPresets') || '{}');
        let currentRandomIngredient = null;

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
        document.addEventListener('DOMContentLoaded', function() {
            updateStats();
            loadHistory();
            loadCookbook();
            setupKeyboardShortcuts();
            updatePrediction();
        });

        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è/–ø–æ–∫–∞–∑—É –ø—Ä–∞–≤–∏–ª
        function toggleRules() {
            const content = document.getElementById('rulesContent');
            const button = document.getElementById('rulesToggle');
            
            if (content.style.display === 'none') {
                content.style.display = 'block';
                button.textContent = '–ü—Ä–∏—Ö–æ–≤–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞';
            } else {
                content.style.display = 'none';
                button.textContent = '–ü–æ–∫–∞–∑–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞';
            }
        }

        // –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç—ñ–≤
        function generateRandomIngredient() {
            const ingredient = baseIngredients[Math.floor(Math.random() * baseIngredients.length)];
            currentRandomIngredient = ingredient;
            
            const container = document.getElementById('randomIngredient');
            const ingredientText = Object.entries(ingredient.ingredients)
                .map(([flavor, count]) => `${diceTypes[flavor].emoji}${count}`)
                .join(' ');
            
            container.innerHTML = `
                <div class="p-3 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg border border-indigo-200">
                    <div class="text-center">
                        <div class="text-2xl mb-1">${ingredient.emoji}</div>
                        <div class="font-semibold text-indigo-800">${ingredient.name}</div>
                        <div class="text-sm text-indigo-600">${ingredientText}</div>
                    </div>
                </div>
            `;
        }

        function addRandomToMeal() {
            if (!currentRandomIngredient) {
                showNotification('–°–ø–æ—á–∞—Ç–∫—É –∑–≥–µ–Ω–µ—Ä—É–π—Ç–µ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç!', 'warning');
                return;
            }
            
            Object.entries(currentRandomIngredient.ingredients).forEach(([flavor, count]) => {
                const current = parseInt(document.getElementById(flavor).value) || 0;
                document.getElementById(flavor).value = current + count;
            });
            
            updatePrediction();
            showNotification(`–î–æ–¥–∞–Ω–æ: ${currentRandomIngredient.name}`, 'success');
        }

        // –ö–ª–∞–≤—ñ–∞—Ç—É—Ä–Ω—ñ —Å–∫–æ—Ä–æ—á–µ–Ω–Ω—è
        function setupKeyboardShortcuts() {
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 'Enter') {
                    e.preventDefault();
                    startRolling();
                }
                if (e.key === 'Escape') {
                    closeSaveModal();
                }
            });
        }

        // –û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –∫–∏–¥–∞–Ω–Ω—è –∫—É–±–∏–∫—ñ–≤
        function startRolling() {
            const dicePool = [];
            let idx = 0;
            
            for (const [flavor, info] of Object.entries(diceTypes)) {
                const num = parseInt(document.getElementById(flavor).value) || 0;
                for (let i = 0; i < num; i++) {
                    dicePool.push({
                        flavor: flavor,
                        sides: info.sides,
                        idx: idx++,
                        value: null
                    });
                }
            }

            if (dicePool.length === 0) {
                showNotification('–î–æ–¥–∞–π—Ç–µ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏ –¥–ª—è –ø—Ä–∏–≥–æ—Ç—É–≤–∞–Ω–Ω—è!', 'warning');
                return;
            }

            rollDicePool(dicePool);
            currentDice = dicePool;
            matchedValues = [];
            rollCount++;
            
            updateStats();
            addToHistory();
            
            const resultsSection = document.getElementById('results');
            resultsSection.classList.remove('hidden');
            resultsSection.scrollIntoView({ behavior: 'smooth' });
            
            const output = document.getElementById('output');
            output.innerHTML = '<h3 class="text-lg font-semibold text-gray-800 mb-3">üé≤ –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∫–∏–¥–∞–Ω–Ω—è –∫—É–±–∏–∫—ñ–≤:</h3>';
            
            displayDice(currentDice);
            proceedLogic();
        }

        // –§—É–Ω–∫—Ü—ñ—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∫—É–±–∏–∫—ñ–≤
        function displayDice(dicePool, containerId = 'output') {
            const container = document.getElementById(containerId);
            
            if (dicePool.length === 0) {
                container.innerHTML += '<p class="text-gray-600">–ö—É–±–∏–∫—ñ–≤ –Ω–µ –∑–∞–ª–∏—à–∏–ª–æ—Å—å.</p>';
                return;
            }

            const grouped = {};
            dicePool.forEach(die => {
                if (!grouped[die.flavor]) {
                    grouped[die.flavor] = [];
                }
                grouped[die.flavor].push(die.value);
            });

            let html = '<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">';
            for (const [flavor, rolls] of Object.entries(grouped)) {
                const flavorInfo = diceTypes[flavor];
                html += `
                    <div class="p-4 rounded-lg border-2 bg-${flavorInfo.color}-50 border-${flavorInfo.color}-300">
                        <div class="flex items-center space-x-2 mb-2">
                            <span class="text-2xl">${flavorInfo.emoji}</span>
                            <span class="font-medium text-${flavorInfo.color}-800">${flavorInfo.name} (–∫${flavorInfo.sides})</span>
                        </div>
                        <div class="flex flex-wrap gap-2">
                            ${rolls.map(roll => `
                                <div class="w-10 h-10 bg-${flavorInfo.color}-200 border-2 border-${flavorInfo.color}-400 rounded-lg flex items-center justify-center font-bold text-${flavorInfo.color}-800">
                                    ${roll}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
            html += '</div>';
            
            container.innerHTML += html;
        }

        // –ë–∞–∑–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –≥—Ä–∏
        function rollDie(sides) {
            return Math.floor(Math.random() * sides) + 1;
        }

        function rollDicePool(dicePool) {
            dicePool.forEach(die => {
                die.value = rollDie(die.sides);
            });
            return dicePool;
        }

        function findDuplicates(dicePool) {
            const values = dicePool.map(die => die.value);
            const valueCounts = {};
            values.forEach(value => {
                valueCounts[value] = (valueCounts[value] || 0) + 1;
            });
            
            const duplicates = {};
            for (const [value, count] of Object.entries(valueCounts)) {
                if (count > 1) {
                    duplicates[parseInt(value)] = count;
                }
            }
            return duplicates;
        }

        function diceWithoutValues(dicePool, values) {
            const valueSet = new Set(values);
            return dicePool.filter(die => !valueSet.has(die.value));
        }

        function updateStats() {
            document.getElementById('rollCount').textContent = rollCount;
            document.getElementById('successCount').textContent = successCount;
            
            const avgRating = successCount > 0 ? Math.round(totalRating / successCount * 10) / 10 : 0;
            document.getElementById('avgRating').textContent = avgRating;
            
            localStorage.setItem('beastFeastRollCount', rollCount.toString());
            localStorage.setItem('beastFeastSuccessCount', successCount.toString());
            localStorage.setItem('beastFeastTotalRating', totalRating.toString());
        }

        function addToHistory() {
            const ingredients = {};
            Object.keys(diceTypes).forEach(flavor => {
                const value = parseInt(document.getElementById(flavor).value) || 0;
                if (value > 0) ingredients[flavor] = value;
            });
            
            const token = parseInt(document.getElementById('token').value) || 0;
            
            const entry = {
                timestamp: new Date().toLocaleString('uk-UA'),
                ingredients: ingredients,
                token: token,
                id: Date.now()
            };
            
            gameHistory.unshift(entry);
            gameHistory = gameHistory.slice(0, 15);
            
            localStorage.setItem('beastFeastHistory', JSON.stringify(gameHistory));
            loadHistory();
        }

        function loadHistory() {
            const historyList = document.getElementById('historyList');
            
            if (gameHistory.length === 0) {
                historyList.innerHTML = '<p class="text-gray-500 text-sm italic">–Ü—Å—Ç–æ—Ä—ñ—è –∫–∏–¥–∫—ñ–≤ –∑\'—è–≤–∏—Ç—å—Å—è —Ç—É—Ç...</p>';
                return;
            }
            
            historyList.innerHTML = gameHistory.map(entry => `
                <div class="p-2 bg-gray-50 rounded border text-xs">
                    <div class="font-medium text-gray-800">${entry.timestamp.split(', ')[1]}</div>
                    <div class="text-gray-600">
                        ${Object.entries(entry.ingredients).map(([flavor, count]) => 
                            `${diceTypes[flavor].emoji}${count}`
                        ).join(' ')}
                        ${entry.token > 0 ? ` ü™ô${entry.token}` : ''}
                    </div>
                </div>
            `).join('');
        }

        function clearHistory() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—é —ñ—Å—Ç–æ—Ä—ñ—é?')) {
                gameHistory = [];
                localStorage.removeItem('beastFeastHistory');
                loadHistory();
            }
        }

        // –®–≤–∏–¥–∫—ñ –ø—Ä–µ—Å–µ—Ç–∏
        function loadPreset(type) {
            clearAll();
            
            switch(type) {
                case 'simple':
                    document.getElementById('salty').value = 1;
                    document.getElementById('savory').value = 2;
                    break;
                case 'wyvern':
                    document.getElementById('sour').value = 1;
                    document.getElementById('savory').value = 1;
                    document.getElementById('weird').value = 1;
                    break;
                case 'mushroom':
                    document.getElementById('bitter').value = 1;
                    document.getElementById('savory').value = 2;
                    break;
                case 'complex':
                    Object.keys(diceTypes).forEach(flavor => {
                        document.getElementById(flavor).value = 1;
                    });
                    break;
                case 'special':
                    document.getElementById('sweet').value = 1;
                    document.getElementById('salty').value = 1;
                    document.getElementById('sour').value = 1;
                    break;
            }
            
            updatePrediction();
            showNotification('–†–µ—Ü–µ–ø—Ç –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ', 'success');
        }

        function adjustInput(flavor, delta) {
            const input = document.getElementById(flavor);
            const newValue = Math.max(0, Math.min(20, parseInt(input.value) + delta));
            input.value = newValue;
            updatePrediction();
        }

        function clearAll() {
            Object.keys(diceTypes).forEach(flavor => {
                document.getElementById(flavor).value = 0;
            });
            document.getElementById('token').value = 0;
            updatePrediction();
        }

        function randomizeIngredients() {
            clearAll();
            const numIngredients = Math.floor(Math.random() * 3) + 1;
            
            for (let i = 0; i < numIngredients; i++) {
                const flavors = Object.keys(diceTypes);
                const flavor = flavors[Math.floor(Math.random() * flavors.length)];
                const current = parseInt(document.getElementById(flavor).value) || 0;
                document.getElementById(flavor).value = current + Math.floor(Math.random() * 3) + 1;
            }
            
            updatePrediction();
            showNotification('–í–∏–ø–∞–¥–∫–æ–≤—ñ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏ –¥–æ–¥–∞–Ω—ñ!', 'info');
        }

        function updatePrediction() {
            const prediction = document.getElementById('prediction');
            const totalDice = Object.keys(diceTypes).reduce((sum, flavor) => {
                return sum + (parseInt(document.getElementById(flavor).value) || 0);
            }, 0);
            
            if (totalDice === 0) {
                prediction.classList.add('hidden');
                return;
            }
            
            const token = parseInt(document.getElementById('token').value) || 0;
            let message = `üé≤ ${totalDice} –∫—É–±–∏–∫—ñ–≤ —Å–º–∞–∫—É`;
            
            if (token > 0) {
                message += ` + ü™ô ${token} —Ç–æ–∫–µ–Ω—ñ–≤ –¥–æ—Å–≤—ñ–¥—É`;
            }
            
            // –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ –∑–±—ñ–≥—ñ–≤
            if (totalDice >= 8) {
                message += `. –î—É–∂–µ –≤–∏—Å–æ–∫–∞ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –∑–±—ñ–≥—ñ–≤! üéØ`;
            } else if (totalDice >= 5) {
                message += `. –í–∏—Å–æ–∫–∞ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –∑–±—ñ–≥—ñ–≤ ü§û`;
            } else if (totalDice >= 3) {
                message += `. –ü–æ–º—ñ—Ä–Ω–∞ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –∑–±—ñ–≥—ñ–≤ üòê`;
            } else {
                message += `. –ù–∏–∑—å–∫–∞ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –∑–±—ñ–≥—ñ–≤ üòÖ`;
            }
            
            prediction.querySelector('p').textContent = message;
            prediction.classList.remove('hidden');
        }

        function showNotification(message, type = 'info') {
            const colors = {
                'success': 'bg-green-500',
                'warning': 'bg-yellow-500',
                'error': 'bg-red-500',
                'info': 'bg-blue-500'
            };
            
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 ${colors[type]} text-white px-4 py-2 rounded-lg shadow-lg z-50 transform transition-transform duration-300`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // –ü—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è –ª–æ–≥—ñ–∫–∏ –≥—Ä–∏
        function proceedLogic() {
            const output = document.getElementById('output');
            const duplicates = findDuplicates(currentDice);
            
            if (currentDice.length === 1) {
                const die = currentDice[0];
                const flavorInfo = diceTypes[die.flavor];
                output.innerHTML += `
                    <div class="mt-4 p-4 bg-green-100 border border-green-300 rounded-lg">
                        <p class="text-green-800 font-semibold">
                            ‚úÖ –û—Å—Ç–∞–Ω–Ω—ñ–π —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç: ${flavorInfo.emoji} ${flavorInfo.name} (–∫${die.sides}) = ${die.value}
                        </p>
                        <p class="text-green-700 mt-2">–°—Ç—Ä–∞–≤–∞ –≥–æ—Ç–æ–≤–∞! üçΩÔ∏è</p>
                    </div>
                `;
                
                if (matchedValues.length > 0) {
                    showGrandTotal();
                    successCount++;
                    const rating = calculateMealRating();
                    totalRating += rating;
                    updateStats();
                    addToCookbook(rating);
                }
                showResetButton();
                return;
            }

            if (Object.keys(duplicates).length === 0) {
                output.innerHTML += `
                    <div class="mt-4 p-4 bg-yellow-100 border border-yellow-300 rounded-lg">
                        <p class="text-yellow-800">‚ö†Ô∏è –°–º–∞–∫–∏ –Ω–µ –∑–º—ñ—à–∞–ª–∏—Å—å. –í–∏–±–µ—Ä—ñ—Ç—å —â–æ –ø—Ä–∏–±—Ä–∞—Ç–∏:</p>
                    </div>
                `;
                showRemoveOptions();
            } else {
                output.innerHTML += '<div class="mt-4 p-4 bg-blue-100 border border-blue-300 rounded-lg">';
                output.innerHTML += '<p class="text-blue-800 font-semibold mb-2">üéØ –°–º–∞–∫–∏ –∑–ª–∏–ª–∏—Å—å —É—Å–ø—ñ—à–Ω–æ:</p>';
                
                for (const [value, count] of Object.entries(duplicates)) {
                    const flavors = currentDice
                        .filter(die => die.value === parseInt(value))
                        .map(die => diceTypes[die.flavor].name);
                    const uniqueFlavors = [...new Set(flavors)];
                    
                    output.innerHTML += `<p class="text-blue-700">‚Ä¢ –ó–Ω–∞—á–µ–Ω–Ω—è ${value} (${count} —Ä–∞–∑—ñ–≤): ${uniqueFlavors.join(', ')}</p>`;
                }
                output.innerHTML += '</div>';

                for (const value of Object.keys(duplicates)) {
                    const numValue = parseInt(value);
                    if (!matchedValues.includes(numValue)) {
                        matchedValues.push(numValue);
                    }
                }

                const matchedSet = Object.keys(duplicates).map(v => parseInt(v));
                const remaining = diceWithoutValues(currentDice, matchedSet);
                
                if (remaining.length === 0) {
                    output.innerHTML += `
                        <div class="mt-4 p-4 bg-green-100 border border-green-300 rounded-lg">
                            <p class="text-green-800 font-semibold">üéâ –í—Å—ñ —Å–º–∞–∫–∏ —ñ–¥–µ–∞–ª—å–Ω–æ –∑–±–∞–ª–∞–Ω—Å–æ–≤–∞–Ω—ñ!</p>
                        </div>
                    `;
                    if (matchedValues.length > 0) {
                        showGrandTotal();
                        successCount++;
                        const rating = calculateMealRating();
                        totalRating += rating;
                        updateStats();
                        addToCookbook(rating);
                    }
                    showResetButton();
                    return;
                }

                output.innerHTML += `
                    <div class="mt-4 p-4 bg-gray-100 border border-gray-300 rounded-lg">
                        <p class="text-gray-800">üîÑ ${remaining.length} —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç—ñ–≤ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å –¥–æ–¥–∞—Ç–∫–æ–≤–æ–≥–æ –∑–º—ñ—à—É–≤–∞–Ω–Ω—è.</p>
                    </div>
                `;
                
                showRerollButton(remaining);
            }
        }

        function showRemoveOptions() {
            const output = document.getElementById('output');
            
            let options = '<select id="removeSelect" class="w-full p-2 border border-gray-300 rounded-md mb-3">';
            
            currentDice.forEach(die => {
                const flavorInfo = diceTypes[die.flavor];
                options += `<option value="die-${die.idx}">${flavorInfo.emoji} ${flavorInfo.name} (–∫${die.sides}) ‚Üí ${die.value}</option>`;
            });
            
            const tokenValue = parseInt(document.getElementById('token').value) || 0;
            if (tokenValue > 0) {
                options += `<option value="token">ü™ô –¢–æ–∫–µ–Ω –¥–æ—Å–≤—ñ–¥—É (${tokenValue})</option>`;
            }
            
            options += '</select>';
            
            output.innerHTML += `
                <div class="mt-4 p-4 bg-white border border-gray-300 rounded-lg">
                    <p class="text-gray-800 mb-3">–í–∏–±–µ—Ä—ñ—Ç—å —â–æ –ø—Ä–∏–±—Ä–∞—Ç–∏ –∑—ñ —Å—Ç—Ä–∞–≤–∏:</p>
                    ${options}
                    <button onclick="removeAndReroll()" class="w-full bg-orange-500 hover:bg-orange-600 text-white font-semibold py-2 px-4 rounded-lg transition duration-200">
                        üóëÔ∏è –ü—Ä–∏–±—Ä–∞—Ç–∏ —Ç–∞ –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏
                    </button>
                </div>
            `;
        }

        function removeAndReroll() {
            const select = document.getElementById('removeSelect');
            const value = select.value;
            
            if (value.startsWith('die-')) {
                const idx = parseInt(value.split('-')[1]);
                currentDice = currentDice.filter(die => die.idx !== idx);
            } else if (value === 'token') {
                const tokenInput = document.getElementById('token');
                tokenInput.value = Math.max(0, parseInt(tokenInput.value) - 1);
            }
            
            rollDicePool(currentDice);
            
            const output = document.getElementById('output');
            output.innerHTML = '<h3 class="text-lg font-semibold text-gray-800 mb-3">üîÑ –ü—Ä–æ–¥–æ–≤–∂—É—î–º–æ –≥–æ—Ç—É–≤–∞–Ω–Ω—è:</h3>';
            displayDice(currentDice);
            proceedLogic();
        }

        function showRerollButton(remaining) {
            const output = document.getElementById('output');
            
            output.innerHTML += `
                <div class="mt-4">
                    <button onclick="rerollRemaining(${JSON.stringify(remaining).replace(/"/g, '&quot;')})" 
                            class="w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg transition duration-200">
                        üé≤ –ü–µ—Ä–µ–º—ñ—à–∞—Ç–∏ —Ä–µ—à—Ç—É —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç—ñ–≤
                    </button>
                </div>
            `;
        }

        function rerollRemaining(remaining) {
            currentDice = remaining;
            rollDicePool(currentDice);
            
            const output = document.getElementById('output');
            output.innerHTML = '<h3 class="text-lg font-semibold text-gray-800 mb-3">üîÑ –ü–µ—Ä–µ–º—ñ—à—É—î–º–æ —Ä–µ—à—Ç—É:</h3>';
            displayDice(currentDice);
            proceedLogic();
        }

        function calculateMealRating() {
            const uniqueValues = [...new Set(matchedValues)];
            return uniqueValues.reduce((sum, val) => sum + val, 0);
        }

        function showGrandTotal() {
            const output = document.getElementById('output');
            const uniqueValues = [...new Set(matchedValues)].sort((a, b) => a - b);
            const grandTotal = uniqueValues.reduce((sum, val) => sum + val, 0);
            const detail = uniqueValues.join(' + ');
            
            let qualityClass = 'bg-gray-100 border-gray-300 text-gray-800';
            let qualityText = '–ü—Ä–æ–≤–∞–ª';
            let qualityEmoji = 'üòû';
            
            if (grandTotal >= 20) {
                qualityClass = 'bg-purple-100 border-purple-300 text-purple-800';
                qualityText = '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞ —Å—Ç—Ä–∞–≤–∞!';
                qualityEmoji = 'üèÜ';
            } else if (grandTotal >= 15) {
                qualityClass = 'bg-orange-100 border-orange-300 text-orange-800';
                qualityText = '–í—ñ–¥–º—ñ–Ω–Ω–∞ —Å—Ç—Ä–∞–≤–∞!';
                qualityEmoji = '‚≠ê';
            } else if (grandTotal >= 10) {
                qualityClass = 'bg-green-100 border-green-300 text-green-800';
                qualityText = '–•–æ—Ä–æ—à–∞ —Å—Ç—Ä–∞–≤–∞!';
                qualityEmoji = 'üëç';
            } else if (grandTotal >= 5) {
                qualityClass = 'bg-yellow-100 border-yellow-300 text-yellow-800';
                qualityText = '–ó–≤–∏—á–∞–π–Ω–∞ —Å—Ç—Ä–∞–≤–∞';
                qualityEmoji = 'üçΩÔ∏è';
            }
            
            output.innerHTML += `
                <div class="mt-4 p-6 ${qualityClass} border-2 rounded-lg">
                    <div class="text-center">
                        <div class="text-4xl mb-2">${qualityEmoji}</div>
                        <p class="font-bold text-xl mb-2">
                            –†–µ–π—Ç–∏–Ω–≥ —Å—Ç—Ä–∞–≤–∏: ${detail} = ${grandTotal}
                        </p>
                        <p class="text-lg">
                            ${qualityText}
                        </p>
                    </div>
                </div>
            `;
        }

        function showResetButton() {
            const output = document.getElementById('output');
            
            output.innerHTML += `
                <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-3">
                    <button onclick="resetGame()" 
                            class="bg-green-500 hover:bg-green-600 text-white font-semibold py-3 px-6 rounded-lg transition duration-200">
                        üçΩÔ∏è –ü—Ä–∏–≥–æ—Ç—É–≤–∞—Ç–∏ –Ω–æ–≤—É —Å—Ç—Ä–∞–≤—É
                    </button>
                    <button onclick="saveCurrentRecipe()" 
                            class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg transition duration-200">
                        üìñ –î–æ–¥–∞—Ç–∏ –¥–æ –∫—É–ª—ñ–Ω–∞—Ä–Ω–æ—ó –∫–Ω–∏–≥–∏
                    </button>
                </div>
            `;
        }

        // –ö—É–ª—ñ–Ω–∞—Ä–Ω–∞ –∫–Ω–∏–≥–∞
        function addToCookbook(rating) {
            const ingredients = {};
            Object.keys(diceTypes).forEach(flavor => {
                const value = parseInt(document.getElementById(flavor).value) || 0;
                if (value > 0) ingredients[flavor] = value;
            });
            
            const token = parseInt(document.getElementById('token').value) || 0;
            const uniqueValues = [...new Set(matchedValues)];
            
            const recipe = {
                id: Date.now(),
                name: `–°—Ç—Ä–∞–≤–∞ ${new Date().toLocaleDateString('uk-UA')}`,
                ingredients: ingredients,
                token: token,
                result: uniqueValues,
                rating: rating,
                timestamp: new Date().toLocaleString('uk-UA'),
                notes: ''
            };
            
            cookbook.unshift(recipe);
            cookbook = cookbook.slice(0, 50);
            
            localStorage.setItem('beastFeastCookbook', JSON.stringify(cookbook));
            loadCookbook();
        }

        function loadCookbook() {
            const cookbookDiv = document.getElementById('cookbook');
            
            if (cookbook.length === 0) {
                cookbookDiv.innerHTML = '<p class="text-gray-500 text-sm italic">–£—Å–ø—ñ—à–Ω—ñ —Ä–µ—Ü–µ–ø—Ç–∏ –≥—Ä—É–ø–∏ –∑\'—è–≤–ª—è—Ç—å—Å—è —Ç—É—Ç...</p>';
                return;
            }
            
            cookbookDiv.innerHTML = cookbook.map(recipe => {
                const ingredientText = Object.entries(recipe.ingredients)
                    .map(([flavor, count]) => `${diceTypes[flavor].emoji}${count}`)
                    .join(' ');
                
                let qualityClass = 'from-gray-50 to-gray-100 border-gray-300';
                if (recipe.rating >= 20) qualityClass = 'from-purple-50 to-purple-100 border-purple-300';
                else if (recipe.rating >= 15) qualityClass = 'from-orange-50 to-orange-100 border-orange-300';
                else if (recipe.rating >= 10) qualityClass = 'from-green-50 to-green-100 border-green-300';
                else if (recipe.rating >= 5) qualityClass = 'from-yellow-50 to-yellow-100 border-yellow-300';
                
                return `
                    <div class="p-3 bg-gradient-to-r ${qualityClass} rounded border text-xs">
                        <div class="font-medium text-gray-800 mb-1">${recipe.name}</div>
                        <div class="text-gray-600 mb-1">
                            ${ingredientText}
                            ${recipe.token > 0 ? ` ü™ô${recipe.token}` : ''}
                        </div>
                        <div class="flex justify-between items-center">
                            <div class="text-sm font-semibold text-gray-700">
                                –†–µ–π—Ç–∏–Ω–≥: ${recipe.rating}
                            </div>
                            <button onclick="loadRecipe(${recipe.id})" class="text-blue-600 hover:text-blue-800 text-xs">
                                üìã –ü–æ–≤—Ç–æ—Ä–∏—Ç–∏
                            </button>
                        </div>
                        ${recipe.notes ? `<div class="text-xs text-gray-500 mt-1 italic">${recipe.notes}</div>` : ''}
                    </div>
                `;
            }).join('');
        }

        function loadRecipe(id) {
            const recipe = cookbook.find(r => r.id === id);
            if (!recipe) return;
            
            clearAll();
            
            Object.entries(recipe.ingredients).forEach(([flavor, count]) => {
                document.getElementById(flavor).value = count;
            });
            
            if (recipe.token > 0) {
                document.getElementById('token').value = recipe.token;
            }
            
            updatePrediction();
            showNotification(`–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ: ${recipe.name}`, 'success');
        }

        function exportCookbook() {
            if (cookbook.length === 0) {
                showNotification('–ö—É–ª—ñ–Ω–∞—Ä–Ω–∞ –∫–Ω–∏–≥–∞ –ø–æ—Ä–æ–∂–Ω—è!', 'warning');
                return;
            }
            
            const text = "üçñ –ö–£–õ–Ü–ù–ê–†–ù–ê –ö–ù–ò–ì–ê –ì–†–£–ü–ò - BEAST FEAST\n" +
                "=" + "=".repeat(50) + "\n\n" +
                cookbook.map(recipe => 
                    `üìñ ${recipe.name}\n` +
                    `üóìÔ∏è –î–∞—Ç–∞: ${recipe.timestamp}\n` +
                    `ü•Ñ –Ü–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏: ${Object.entries(recipe.ingredients).map(([flavor, count]) => 
                        `${diceTypes[flavor].name}(${count})`
                    ).join(', ')}\n` +
                    `${recipe.token > 0 ? `ü™ô –¢–æ–∫–µ–Ω–∏ –¥–æ—Å–≤—ñ–¥—É: ${recipe.token}\n` : ''}` +
                    `‚≠ê –†–µ–π—Ç–∏–Ω–≥ —Å—Ç—Ä–∞–≤–∏: ${recipe.rating}\n` +
                    `üìù –ó–±—ñ–≥–∏: [${recipe.result.join(', ')}]\n` +
                    `${recipe.notes ? `üìã –ù–æ—Ç–∞—Ç–∫–∏: ${recipe.notes}\n` : ''}` +
                    `${'-'.repeat(40)}\n\n`
                ).join('');
            
            const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `beast-feast-cookbook-${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('–ö—É–ª—ñ–Ω–∞—Ä–Ω–∞ –∫–Ω–∏–≥–∞ –µ–∫—Å–ø–æ—Ä—Ç–æ–≤–∞–Ω–∞!', 'success');
        }

        // –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è
        function savePreset() {
            document.getElementById('saveModal').classList.remove('hidden');
            document.getElementById('recipeName').focus();
        }

        function closeSaveModal() {
            document.getElementById('saveModal').classList.add('hidden');
            document.getElementById('recipeName').value = '';
            document.getElementById('recipeNotes').value = '';
        }

        function confirmSavePreset() {
            const name = document.getElementById('recipeName').value.trim();
            const notes = document.getElementById('recipeNotes').value.trim();
            
            if (!name) {
                showNotification('–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É —Å—Ç—Ä–∞–≤–∏!', 'warning');
                return;
            }
            
            const ingredients = {};
            Object.keys(diceTypes).forEach(flavor => {
                const value = parseInt(document.getElementById(flavor).value) || 0;
                if (value > 0) ingredients[flavor] = value;
            });
            
            const token = parseInt(document.getElementById('token').value) || 0;
            
            // –Ø–∫—â–æ —Ü–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø—ñ—Å–ª—è –≥–æ—Ç—É–≤–∞–Ω–Ω—è
            if (matchedValues.length > 0) {
                const uniqueValues = [...new Set(matchedValues)];
                const rating = uniqueValues.reduce((sum, val) => sum + val, 0);
                
                const recipe = {
                    id: Date.now(),
                    name: name,
                    ingredients: ingredients,
                    token: token,
                    result: uniqueValues,
                    rating: rating,
                    timestamp: new Date().toLocaleString('uk-UA'),
                    notes: notes
                };
                
                cookbook.unshift(recipe);
                cookbook = cookbook.slice(0, 50);
                localStorage.setItem('beastFeastCookbook', JSON.stringify(cookbook));
                loadCookbook();
            } else {
                // –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —è–∫ –ø—Ä–µ—Å–µ—Ç
                savedPresets[name] = { ingredients, token, notes };
                localStorage.setItem('beastFeastPresets', JSON.stringify(savedPresets));
            }
            
            closeSaveModal();
            showNotification(`"${name}" –∑–±–µ—Ä–µ–∂–µ–Ω–æ –¥–æ –∫—É–ª—ñ–Ω–∞—Ä–Ω–æ—ó –∫–Ω–∏–≥–∏!`, 'success');
        }

        function saveCurrentRecipe() {
            savePreset();
        }

        function resetGame() {
            Object.keys(diceTypes).forEach(flavor => {
                document.getElementById(flavor).value = 0;
            });
            document.getElementById('token').value = 0;
            
            currentDice = [];
            matchedValues = [];
            
            document.getElementById('results').classList.add('hidden');
            document.getElementById('output').innerHTML = '';
            
            updatePrediction();
            showNotification('–ì–æ—Ç–æ–≤—ñ –¥–æ –Ω–æ–≤–∏—Ö –∫—É–ª—ñ–Ω–∞—Ä–Ω–∏—Ö –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤! üç≥', 'success');
        }

        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–Ω—è –ø—Ä–∏ –∑–º—ñ–Ω—ñ —ñ–Ω–ø—É—Ç—ñ–≤
        Object.keys(diceTypes).forEach(flavor => {
            document.getElementById(flavor).addEventListener('input', updatePrediction);
        });
        document.getElementById('token').addEventListener('input', updatePrediction);
    </script>
</body>
</html>
